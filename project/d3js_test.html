<!DOCTYPE html>
<html>
  <head>
    <title>Simple Map</title>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 400px;
        width: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  
  <body>
  	<h1><center>My Google Map</center></h1>
    <div id="map"></div>
    <script>
      function initMap() {
        // options
        var options = {
        	zoom: 15,
        	center: {lat: 25.0169826, lng: 121.5376303}
        }
        
        // New map
        var map = new google.maps.Map(document.getElementById('map'), options);
      	
        // default icons
      	var mc_icon = {
		    url: "https://ntu-csx-d3js.github.io/b05902108/project/image/mcdonald_icon.png", // url
		    scaledSize: new google.maps.Size(25, 25), // scaled size
		};
		var star_icon = {
		    url: "https://ntu-csx-d3js.github.io/b05902108/project/image/starbucks_icon.png", // url
		    scaledSize: new google.maps.Size(25, 25), // scaled size
		};

      	// deal with starbuck data
      	$.getJSON("https://ntu-csx-d3js.github.io/b05902108/project/data/starbucks.json", function(starData) {
		    console.log(starData); 
		    var d_len = starData.length;
		    for(var i = 0; i < d_len; i++){
	      		addMarker(starData[i], star_icon);
	      	}
	      	 
	      	// draw circle with problistic density function
	      	var center_lat = 0;
	      	var center_lng = 0;
	      	var max_len = 0;
	      	for(var i = 0; i < d_len; i++){
	      		center_lat = center_lat + starData[i].coords.lat;
	      		center_lng = center_lng + starData[i].coords.lng;
	      	}
	      	center_lat = center_lat/d_len;
	      	center_lng = center_lng/d_len;
	      	center = {lat: center_lat, lng: center_lng};
	      	var cityCircle = new google.maps.Circle({
	            strokeColor: '#FFFFFF',
	            strokeOpacity: 0.8,
	            strokeWeight: 2,
	            fillColor: '#FF0000',
	            fillOpacity: 0.35,
	            map: map,
	            center: center,
	            radius: 2000
	        });

		});
      	
      	// Add Marker Function
      	function addMarker(props, what_icon){
      		var marker = new google.maps.Marker({
	      		position: props.coords,
	      		map: map,
	      		icon: what_icon
	      	});

      		if(what_icon){
      			marker.setIcon(what_icon);
      		}
      		if(props.content){
      			var infoWindow = new google.maps.InfoWindow({
		      		content: props.content
		      	});

		      	marker.addListener('click', function(){
		      		infoWindow.open(map, marker);
		      	})
      		}
      	}
      
      }
      
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDCHe_BArJHasg07-VcENIwq0Pjeork94g&callback=initMap"
    async defer></script>


    <div id="">
    	<h1><center>統計星巴克和麥當勞的...(暫定)</center></h1>
    	<p>
    		目前沒有發現什麼。
    	</p>	
    </div>
  </body>
</html>